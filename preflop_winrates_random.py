preflop_winrates_random = {
    "22": 50.36, "32o": 32.09, "32s": 35.9, "42o": 33.23, "42s": 36.83,
    "52o": 34.3, "52s": 38.09, "62o": 33.95, "62s": 37.44, "72o": 34.38,
    "72s": 38.17, "82o": 37.06, "82s": 40.61, "92o": 39.1, "92s": 42.4,
    "A2o": 55.07, "A2s": 57.67, "J2o": 44.62, "J2s": 47.09, "K2o": 50.39,
    "K2s": 52.94, "Q2o": 47.15, "Q2s": 50.25, "T2o": 41.49, "T2s": 44.81,
    "33": 53.5, "43o": 35.08, "43s": 38.57, "53o": 36.22, "53s": 39.54,
    "63o": 35.85, "63s": 39.54, "73o": 36.63, "73s": 40.07, "83o": 37.87,
    "83s": 41.13, "93o": 40.25, "93s": 43.41, "A3o": 55.54, "A3s": 58.26,
    "J3o": 44.97, "J3s": 48.32, "K3o": 51.16, "K3s": 53.94, "Q3o": 48.16,
    "Q3s": 50.98, "T3o": 42.31, "T3s": 45.83, "44": 57.06, "54o": 38.2,
    "54s": 41.44, "64o": 38.06, "64s": 41.25, "74o": 38.61, "74s": 41.77,
    "84o": 39.41, "84s": 43.11, "94o": 40.57, "94s": 44.1, "A4o": 56.73,
    "A4s": 59.11, "J4o": 46.26, "J4s": 49.13, "K4o": 52.11, "K4s": 54.71,
    "Q4o": 49.22, "Q4s": 51.71, "T4o": 43.39, "T4s": 46.55, "55": 60.36,
    "65o": 39.86, "65s": 43.04, "75o": 40.49, "75s": 43.94, "85o": 41.28,
    "85s": 44.46, "95o": 42.62, "95s": 45.96, "A5o": 57.57, "A5s": 60.02,
    "J5o": 47.32, "J5s": 50.01, "K5o": 53.16, "K5s": 55.77, "Q5o": 50.11,
    "Q5s": 52.72, "T5o": 44.4, "T5s": 46.9, "66": 63.35, "76o": 42.14,
    "76s": 45.43, "86o": 43.28, "86s": 45.95, "96o": 44.46, "96s": 47.41,
    "A6o": 57.86, "A6s": 60.04, "J6o": 47.94, "J6s": 50.73, "K6o": 54.29,
    "K6s": 56.83, "Q6o": 51.25, "Q6s": 53.56, "T6o": 46.17, "T6s": 48.87,
    "77": 66.16, "87o": 45.23, "87s": 48.11, "97o": 46.24, "97s": 49.16,
    "A7o": 58.84, "A7s": 61.14, "J7o": 49.68, "J7s": 52.09, "K7o": 55.46,
    "K7s": 57.47, "Q7o": 51.95, "Q7s": 54.5, "T7o": 47.68, "T7s": 50.83,
    "88": 68.94, "98o": 48.12, "98s": 50.94, "A8o": 59.76, "A8s": 61.8,
    "J8o": 51.44, "J8s": 54.03, "K8o": 55.95, "K8s": 58.43, "Q8o": 53.39,
    "Q8s": 55.99, "T8o": 49.65, "T8s": 52.29, "99": 72.07, "A9o": 60.63,
    "A9s": 62.9, "J9o": 53.25, "J9s": 55.85, "K9o": 57.73, "K9s": 59.94,
    "Q9o": 54.98, "Q9s": 57.77, "T9o": 51.75, "T9s": 53.85, "AA": 85.39,
    "AJo": 63.47, "AJs": 65.61, "JJ": 77.47, "KJo": 60.39, "KJs": 62.52,
    "QJo": 58.13, "QJs": 60.28, "AKo": 65.43, "AKs": 67.28, "KK": 82.33,
    "AQo": 64.31, "AQs": 66.13, "KQo": 61.47, "KQs": 63.7, "QQ": 79.73,
    "ATo": 62.93, "ATs": 64.8, "JTo": 55.69, "JTs": 57.39, "KTo": 59.75,
    "KTs": 61.79, "QTo": 57.15, "QTs": 59.58, "TT": 75.01
}


def convert_rank_to_value(rank):
    rank_order = {'2': 2, '3': 3, '4': 4, '5': 5, '6': 6,
                  '7': 7, '8': 8, '9': 9, 'T': 10,
                  'J': 11, 'Q': 12, 'K': 13, 'A': 14}
    return rank_order[rank]


def normalize_hand_key(hand_str):
    if len(hand_str) == 2:
        return hand_str  # ペアはそのまま
    r1, r2, suited = hand_str[0], hand_str[1], hand_str[2]
    v1, v2 = convert_rank_to_value(r1), convert_rank_to_value(r2)
    if v1 < v2:
        r1, r2 = r2, r1
    return f"{r1}{r2}{suited}"


def get_static_preflop_winrate(hand_str):
    """
    プリフロップ勝率を取得（ランダムハンドに対して）
    強いカードが前になるよう正規化してから取得する。
    """
    key = normalize_hand_key(hand_str)
    return preflop_winrates_random.get(key, 50.0)
